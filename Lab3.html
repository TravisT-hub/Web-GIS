<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Lab 3 (Q1+Q2): OpenLayers OSM + Azure Maps</title>

    <!-- OpenLayers and Layer Switcher -->
    <script src="https://cdn.jsdelivr.net/npm/ol@v10.6.1/dist/ol.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v10.6.1/ol.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.2/dist/ol-layerswitcher.css" />
    <script src="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.2/dist/ol-layerswitcher.js"></script>

    <style>
      body { font-family: Arial, sans-serif; margin: 20px; text-align: center; }
      #map { width: 90%; height: 600px; margin: auto; border: 2px solid #444; }
    </style>
  </head>

  <body>
    <h2>Lab 3 (Q1 + Q2): OpenLayers â€“ OSM and Azure Maps for North Carolina</h2>
    <h4>Author: Travis Toomey</h4>
    <div id="map"></div>

    <script>
      // ---- Base Layers ----
      const OSM = new ol.layer.Tile({
        title: "OpenStreetMap",
        type: "base",
        visible: true,
        source: new ol.source.OSM(),
      });

      const AZURE_KEY = "6srLl2o3dGC8xAqJVrOEtVGTFj1ujl40lKOoKJD6f1K3XLS2U5JAJQQJ99BIACYeBjFZ86DdAAAgAZMP4fGn";

      const azureRoad = new ol.layer.Tile({
        title: "Azure Maps (Road)",
        type: "base",
        visible: false,
        source: new ol.source.XYZ({
          url: `https://atlas.microsoft.com/map/tile?api-version=2022-08-01&tilesetId=microsoft.base.road&zoom={z}&x={x}&y={y}&subscription-key=${AZURE_KEY}`,
          crossOrigin: "anonymous",
        }),
      });

      const azureDark = new ol.layer.Tile({
        title: "Azure Maps (Dark Gray)",
        type: "base",
        visible: false,
        source: new ol.source.XYZ({
          url: `https://atlas.microsoft.com/map/tile?api-version=2022-08-01&tilesetId=microsoft.base.darkgrey&zoom={z}&x={x}&y={y}&subscription-key=${AZURE_KEY}`,
          crossOrigin: "anonymous",
        }),
      });

      const azureImagery = new ol.layer.Tile({
        title: "Azure Maps (Imagery)",
        type: "base",
        visible: false,
        source: new ol.source.XYZ({
          url: `https://atlas.microsoft.com/map/tile?api-version=2022-08-01&tilesetId=microsoft.imagery&zoom={z}&x={x}&y={y}&subscription-key=${AZURE_KEY}`,
          crossOrigin: "anonymous",
        }),
      });

      const azureTerra = new ol.layer.Tile({
        title: "Azure Maps (Terra)",
        type: "base",
        visible: false,
        source: new ol.source.XYZ({
          url: `https://atlas.microsoft.com/map/tile?api-version=2022-08-01&tilesetId=microsoft.terra.main&zoom={z}&x={x}&y={y}&subscription-key=${AZURE_KEY}`,
          crossOrigin: "anonymous",
        }),
      });

      const baseGroup = new ol.layer.Group({
        title: "Base Maps",
        layers: [OSM, azureRoad, azureDark, azureImagery, azureTerra],
      });

      // ---- Map Object ----
      const map = new ol.Map({
        target: "map",
        layers: [baseGroup],
        view: new ol.View({
          projection: "EPSG:3857",
          center: ol.proj.fromLonLat([-79.0193, 35.7596]), // North Carolina center
          zoom: 7,
        }),
      });

      // ---- Fit to North Carolina Extent ----
      const ncExtent4326 = [-84.3219, 33.8423, -75.4001, 36.5880];
      const ncExtent3857 = ol.proj.transformExtent(ncExtent4326, "EPSG:4326", "EPSG:3857");
      map.getView().fit(ncExtent3857, { size: map.getSize(), padding: [20, 20, 20, 20], duration: 300 });

      // ---- Layer Switcher ----
      map.addControl(new ol.control.LayerSwitcher({ tipLabel: "Legend" }));
    </script>
  </body>
</html>
